<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Mitchell Kember">
  <title>SICP Lecture 2B Notes</title>
  <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
<svg style="display: none;">
  <symbol id="external">
    <path d="M11 7H6a2 2 0 00-2 2v9a2 2 0 002 2h9a2 2 0 002-2v-5M10 14L20 4M15 4h5v5"/>
  </symbol></svg>
<a class="skip-link" href="#main">Skip to main content</a>
<header class="header ">
  <a class="title link" href="../index.html">SICP Study</a>
  <nav class="sitenav" aria-label="primary">
    <a class="sitenav__item link "
      href="../text/index.html" aria-label="textbook notes">Text</a>
    <a class="sitenav__item link  sitenav__item--active"
      href="../lecture/index.html" aria-label="lecture notes">Lecture</a>
    <a class="sitenav__item link "
      href="../exercise/index.html" aria-label="exercises">Exercise</a>
    <a class="sitenav__item sitenav__item--last link"
      href="https://github.com/mk12/sicp" aria-label="GitHub repository">Source
      <svg alt="" class="github-mark" width="25" height="25" viewBox="0 0 136 133">
        <path d="M67.866.002C30.387.002 0 30.39 0 67.877c0 29.988 19.446 55.425 46.417 64.404 3.396.621 4.633-1.475 4.633-3.275 0-1.608-.058-5.879-.091-11.541-18.88 4.1-22.863-9.1-22.863-9.1-3.087-7.838-7.537-9.925-7.537-9.925-6.163-4.213.466-4.13.466-4.13 6.813.484 10.396 6.996 10.396 6.996 6.054 10.371 15.888 7.375 19.754 5.642.617-4.387 2.367-7.38 4.309-9.075-15.071-1.712-30.917-7.537-30.917-33.546 0-7.408 2.646-13.466 6.988-18.212-.7-1.717-3.03-8.617.662-17.963 0 0 5.7-1.825 18.667 6.959 5.412-1.505 11.22-2.259 16.992-2.284 5.762.025 11.57.78 16.991 2.284 12.959-8.784 18.646-6.959 18.646-6.959 3.704 9.346 1.375 16.246.675 17.963 4.35 4.746 6.98 10.804 6.98 18.212 0 26.075-15.872 31.813-30.992 33.492 2.437 2.096 4.608 6.237 4.608 12.57 0 9.072-.083 16.392-.083 18.617 0 1.817 1.22 3.93 4.666 3.267 26.95-8.996 46.38-34.417 46.38-64.396 0-37.487-30.392-67.875-67.88-67.875"/>
      </svg>
    </a>
  </nav>
</header>
<nav class="pagenav pagenav--top" aria-label="secondary">
  <div class="pagenav__item pagenav__item--prev">
    <a class="pagenav__link link" href="2a.html" aria-label="Previous page">
      <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M5 12h14M5 12l6 6M5 12l6-6"/>
  </svg> Prev
    </a>
  </div>
  <div class="pagenav__item pagenav__item--up">
    <a class="pagenav__link link" href="index.html" aria-label="Parent page">
      <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M12 5v14M18 11l-6-6M6 11l6-6"/>
  </svg> Up
    </a>
  </div>
  <div class="pagenav__item pagenav__item--next">
    <a class="pagenav__link link" href="3a.html" aria-label="Next page">
      Next <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M5 12h14M13 18l6-6M13 6l6 6"/>
  </svg>
    </a>
  </div>

  </nav>
<main id="main">

<h1>
<span class="number">2B</span> <a class="link" href="https://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-001-structure-and-interpretation-of-computer-programs-spring-2005/video-lectures/2b-compound-data">Compound Data<span class="nowrap">﻿<svg class="external" viewBox="0 0 24 24"><use xlink:href="#external"/></svg></span></a>
</h1>
<h2 id="1" class="anchor">
<a class="anchor__link link" href="#1" aria-hidden="true">#</a>Part 1
</h2>
<h3 id="1.1" class="anchor">
<a class="anchor__link link" href="#1.1" aria-hidden="true">#</a>Recap
</h3>
<p>In the beginning, we learned about</p>
<ul>
<li>primitive forms</li>
<li>means of combination</li>
<li>means of abstraction</li>
</ul>
<p>Then, we learned how to use higher-order procedures to represent general methods of computation. This gave us extraordinary expressive power.</p>
<h3 id="1.2" class="anchor">
<a class="anchor__link link" href="#1.2" aria-hidden="true">#</a>Layered system
</h3>
<ul>
<li>When we wrote the square root procedure, we used layers of abstraction. Someone else could have written <code class="sourceCode scheme">good-enough?</code>.</li>
</ul>
<blockquote>
<p>The crucial idea is that when we’re building things, we divorce the task of building things from the task implementing the parts.</p>
</blockquote>
<ul>
<li>In a large system, we have lots of <em>abstraction barriers</em>.</li>
<li>Now we will look at the same issues for data.</li>
<li>There are means of combination for data as well, allowing us to combine primitive data into compound data.</li>
<li>We will also see a methodology for abstraction with data.</li>
<li>Key idea: build the system in layers, with abstraction barriers.</li>
</ul>
<h3 id="1.3" class="anchor">
<a class="anchor__link link" href="#1.3" aria-hidden="true">#</a>Rational number arithmetic
</h3>
<ul>
<li>We already know how to express the arithmetic operators for fractions in math.</li>
<li>Combining two fractions with addition, subtraction, multiplication, or division produces another fraction.</li>
<li>The computations are easy—but how to we represent a rational number? They are not primitive numbers.</li>
<li>We need to apply the strategy of wishful thinking: let’s imagine that we have procedures <code class="sourceCode scheme">make-rat</code>, <code class="sourceCode scheme">numer</code>, and <code class="sourceCode scheme">denom</code>.</li>
<li>We can implement a procedure for adding rationals like so:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">define</span> (+rat x y)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (make-rat</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   (<span class="fu">+</span> (<span class="fu">*</span> (numer x) (denom y))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>      (<span class="fu">*</span> (numer y) (denom x)))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>   (<span class="fu">*</span> (denom x) (denom y))))</span></code></pre></div>
<ul>
<li>The procedure <code class="sourceCode scheme">make-rat</code> is called a <em>constructor</em>.</li>
<li>The procedures <code class="sourceCode scheme">numer</code> and <code class="sourceCode scheme">denom</code> are called <em>selectors</em>.</li>
</ul>
<h3 id="1.4" class="anchor">
<a class="anchor__link link" href="#1.4" aria-hidden="true">#</a>Why do we need compound data?
</h3>
<ul>
<li>Why bother with these data objects instead of just passing in four numbers? It doesn’t scale, and there is no abstraction.</li>
<li>We would have to worry about all these temporary numbers.</li>
<li>It’s confusing. We need abstraction.</li>
<li>We need to create compound data objects for the same reason that we separate our program into procedures built on abstractions.</li>
</ul>
<h2 id="2" class="anchor">
<a class="anchor__link link" href="#2" aria-hidden="true">#</a>Part 2
</h2>
<h3 id="2.1" class="anchor">
<a class="anchor__link link" href="#2.1" aria-hidden="true">#</a>Pairs
</h3>
<ul>
<li>How do we actually make one of these “clouds”?</li>
<li>We need a kind of glue to connect things.</li>
<li>Lisp provides this: it is called <em>list structure</em>.</li>
<li>The primitive <code class="sourceCode scheme"><span class="fu">cons</span></code> allows us to construct <em>pairs</em>.</li>
<li><code class="sourceCode scheme"><span class="fu">cons</span></code> is obviously the <strong>cons</strong>tructor.</li>
<li><code class="sourceCode scheme"><span class="fu">car</span></code> and <code class="sourceCode scheme"><span class="fu">cdr</span></code> are the selectors for pairs.</li>
<li>For any <code class="sourceCode scheme">x</code> and <code class="sourceCode scheme">y</code>, <code class="sourceCode scheme">(<span class="fu">car</span> (<span class="fu">cons</span> x y))</code> is <code class="sourceCode scheme">x</code>.</li>
<li>For any <code class="sourceCode scheme">x</code> and <code class="sourceCode scheme">y</code>, <code class="sourceCode scheme">(<span class="fu">cdr</span> (<span class="fu">cons</span> x y))</code> is <code class="sourceCode scheme">y</code>.</li>
<li>We can represent conses with two boxes side by side with an arrow coming from each.</li>
<li>This is called <em>box-and-pointer notation</em>.</li>
</ul>
<h3 id="2.2" class="anchor">
<a class="anchor__link link" href="#2.2" aria-hidden="true">#</a>Lowest terms
</h3>
<ul>
<li>When we use the system to add a half and a quarter, it gives us six eights instead of three quarters. This isn’t what we want.</li>
<li>This isn’t the problem of the addition procedure; the <code class="sourceCode scheme">make-rat</code> procedure should be responsible for reducing to lowest terms.</li>
<li>We can use the greatest common divisor to fix this:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">define</span> (make-rat n d)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">let</span> ((g (<span class="fu">gcd</span> n d)))</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    (<span class="fu">cons</span> (<span class="fu">/</span> n g) (<span class="fu">/</span> d g))))</span></code></pre></div>
<ul>
<li>Now our fractions will always be reduced to lowest terms.</li>
</ul>
<h3 id="2.3" class="anchor">
<a class="anchor__link link" href="#2.3" aria-hidden="true">#</a>Abstraction layer
</h3>
<ul>
<li>The important thing with our rational arithmetic system is the abstraction layer.</li>
<li>We have the rational arithmetic operators on one side and the pair constructor and selectors on the other.</li>
<li>The procedures <code class="sourceCode scheme">make-rat</code>, <code class="sourceCode scheme">numer</code>, and <code class="sourceCode scheme">denom</code> are an abstraction barrier between the two.</li>
<li>We always want to separate <em>use</em> from <em>representation</em>.</li>
<li>This methodology is called <em>data abstraction</em>.</li>
</ul>
<h3 id="2.4" class="anchor">
<a class="anchor__link link" href="#2.4" aria-hidden="true">#</a>Why use data abstraction?
</h3>
<ul>
<li>We didn’t have to do it this way.</li>
<li>We could have used <code class="sourceCode scheme"><span class="fu">cons</span></code>, <code class="sourceCode scheme"><span class="fu">car</span></code>, and <code class="sourceCode scheme"><span class="fu">cdr</span></code> directly in the rational arithmetic procedures.</li>
<li>Is this talk of data abstraction just self-righteous BS?</li>
<li>Maybe it would be marginally more efficient to skip the data abstraction!</li>
<li>It goes back to naming. If you have the name of the spirit, you have control over it.</li>
<li>One advantage: you might want to have alternative representations. If we use <code class="sourceCode scheme"><span class="fu">cons</span></code> directly, we would have to reduce to lowest terms every time we make a rational number.</li>
<li>With the data abstraction, we could even move the lowest terms stuff to the selectors—no other change in the code required.</li>
<li>Data abstraction lets us postpone decisions.</li>
</ul>
<h3 id="2.5" class="anchor">
<a class="anchor__link link" href="#2.5" aria-hidden="true">#</a>Designing systems
</h3>
<blockquote>
<p>See, in general, as systems designers, you’re forced with the necessity to make decisions about how you’re going to do things. And in general, the way to retain flexibility is to never make up your mind about anything until you’re forced to do it. The problem is, there’s a very, very narrow line between deferring decisions and outright procrastination. So you’d like to make progress, but also at the same time never be bound by the consequences of your decisions.</p>
</blockquote>
<blockquote>
<p>I said that computer science is a lot like magic, and it’s sort of good that it’s like magic. There’s a bad part of computer that’s a lot like religion.</p>
</blockquote>
<h2 id="3" class="anchor">
<a class="anchor__link link" href="#3" aria-hidden="true">#</a>Part 3
</h2>
<h3 id="3.1" class="anchor">
<a class="anchor__link link" href="#3.1" aria-hidden="true">#</a>Data abstraction
</h3>
<ul>
<li>Data abstraction is a way of controlling complexity in large systems.</li>
<li>Like all ways of controlling complexity, the real power comes from their use as building blocks for more complicated things.</li>
</ul>
<h3 id="3.2" class="anchor">
<a class="anchor__link link" href="#3.2" aria-hidden="true">#</a>Points and line segments
</h3>
<ul>
<li>We could also use pairs to represent points on a plane.</li>
<li>The constructor and accessors could use <code class="sourceCode scheme"><span class="fu">cons</span></code>, <code class="sourceCode scheme"><span class="fu">car</span></code>, and <code class="sourceCode scheme"><span class="fu">cdr</span></code>, just like in the rational number system.</li>
<li>We could use points (or vectors) as a building block to make line segments. This would be a multi-layered system.</li>
<li>Segments, vectors, and pairs are all separated.</li>
<li>Without data abstraction, the procedure for calculating the length of a line segment is very hard to read; worse, it locks you into decisions about representation.</li>
<li><code class="sourceCode scheme"><span class="fu">cons</span></code> can combine anything, not just numbers. With line segments, we combine two pairs.</li>
<li><em>Closure</em> means we can make pairs of pairs, not just pairs of numbers. We say that the means of combinations closes over the things that it makes.</li>
</ul>
<h2 id="4" class="anchor">
<a class="anchor__link link" href="#4" aria-hidden="true">#</a>Part 4
</h2>
<h3 id="4.1" class="anchor">
<a class="anchor__link link" href="#4.1" aria-hidden="true">#</a>Abstract data and contracts
</h3>
<ul>
<li>We’ve done a few simple examples. Now we’re going to talk about what it <em>means</em>, which is much harder.</li>
<li>At the beginning, we assumed the constructors and selectors for rational numbers existed (without knowing about pairs).</li>
<li>We had defined a rational number representation in terms of <em>abstract data</em>.</li>
<li>There’s a way of saying whether three procedures are suitable as a basis for rational number representation.</li>
<li>We had a contract that the procedures have to fulfill: given a rational number <code class="sourceCode scheme">x</code> created with <code class="sourceCode scheme">(make-rat n d)</code>, we must have <code class="sourceCode scheme">(<span class="fu">=</span> (<span class="fu">/</span> (numer x) (denom x)) (<span class="fu">/</span> n d))</code>.</li>
</ul>
<h3 id="4.2" class="anchor">
<a class="anchor__link link" href="#4.2" aria-hidden="true">#</a>Implementation of pairs
</h3>
<ul>
<li>Rational numbers <em>really</em> are just this contract, this axiom.</li>
<li>They might be realized as pairs in a particular implementation, but that has nothing to do with what pairs really are.</li>
<li>Pairs are the same: they happen to satisfy the contract that <code class="sourceCode scheme">(<span class="fu">car</span> (<span class="fu">cons</span> x y))</code> is <code class="sourceCode scheme">x</code> and <code class="sourceCode scheme">(<span class="fu">cdr</span> (<span class="fu">cons</span> x y))</code> is <code class="sourceCode scheme">y</code>.</li>
<li>We can implement pairs with procedures. We don’t even need special primitives—all we need are lambdas:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">define</span> (<span class="fu">cons</span> a b)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">lambda</span> (pick)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">cond</span> ((<span class="fu">=</span> pick <span class="cn">1</span>) a)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>          ((<span class="fu">=</span> pick <span class="cn">2</span>) b))))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>(<span class="kw">define</span> (<span class="fu">car</span> x) (x <span class="cn">1</span>))</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>(<span class="kw">define</span> (<span class="fu">cdr</span> x) (x <span class="cn">2</span>))</span></code></pre></div>
<ul>
<li>All we need to do is show that this satisfies the axiom.</li>
<li>We can do that with the substitution model. It works.</li>
<li>You couldn’t tell if <code class="sourceCode scheme"><span class="fu">cons</span></code>, <code class="sourceCode scheme"><span class="fu">car</span></code>, and <code class="sourceCode scheme"><span class="fu">cdr</span></code> were implemented in this way or not.</li>
</ul>
<h3 id="4.3" class="anchor">
<a class="anchor__link link" href="#4.3" aria-hidden="true">#</a>Conclusion
</h3>
<ul>
<li>We don’t need data at all for data abstraction: we can do everything with procedures.</li>
<li>This blurs the line between code and data.</li>
<li>Procedures are not just the act of doing something.</li>
<li>Procedures are conceptual entities or objects.</li>
</ul>
</main>
<nav class="pagenav pagenav--bottom" aria-label="secondary">
  <div class="pagenav__item pagenav__item--prev">
    <a class="pagenav__link link" href="2a.html" aria-label="Previous page">
      <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M5 12h14M5 12l6 6M5 12l6-6"/>
  </svg> Prev
    </a>
  </div>
  <div class="pagenav__item pagenav__item--up">
    <a class="pagenav__link link" href="index.html" aria-label="Parent page">
      <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M12 5v14M18 11l-6-6M6 11l6-6"/>
  </svg> Up
    </a>
  </div>
  <div class="pagenav__item pagenav__item--next">
    <a class="pagenav__link link" href="3a.html" aria-label="Next page">
      Next <svg alt="" class="arrow" width="18" height="18" viewBox="0 0 24 24">
    <path d="M5 12h14M13 18l6-6M13 6l6 6"/>
  </svg>
    </a>
  </div>

  </nav>
<footer class="footer">
  <p>© 2020 Mitchell Kember</p>
</footer>
</body>
</html>
