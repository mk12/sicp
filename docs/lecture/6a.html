<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="Mitchell Kember">
  <title>SICP Lecture 6A Notes</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
   var mathElements = document.getElementsByClassName("math");
   var macros = [];
   for (var i = 0; i < mathElements.length; i++) {
    var texText = mathElements[i].firstChild;
    if (mathElements[i].tagName == "SPAN") {
     katex.render(texText.data, mathElements[i], {
      displayMode: mathElements[i].classList.contains('display'),
      throwOnError: false,
      macros: macros,
      fleqn: false
     });
  }}});
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" />
  <link rel="stylesheet" href="../assets/style.css">
</head>
<body>
<header class="header ">
  <a class="title link" href="../index.html">SICP Study</a>
  <nav class="sitenav">
    <a class="sitenav__item link "
      href="../text/index.html">Text</a>
    <a class="sitenav__item link  sitenav__item--active"
      href="../lecture/index.html">Lecture</a>
    <a class="sitenav__item link "
      href="../exercise/index.html">Exercise</a>
    <a class="sitenav__item sitenav__item--last link" href="https://github.com/mk12/sicp">
      Source <svg class="github-mark" width="25" height="25" viewBox="0 0 136 133">
  <g transform="matrix(1,0,0,1,-568.001,-447.669)">
    <g transform="matrix(4.16667,0,0,4.16667,0,0)">
      <g transform="matrix(1,0,0,1,152.608,139.345)">
        <path d="M0,-31.904C-8.995,-31.904 -16.288,-24.611 -16.288,-15.614C-16.288,-8.417 -11.621,-2.312 -5.148,-0.157C-4.333,-0.008 -4.036,-0.511 -4.036,-0.943C-4.036,-1.329 -4.05,-2.354 -4.058,-3.713C-8.589,-2.729 -9.545,-5.897 -9.545,-5.897C-10.286,-7.778 -11.354,-8.279 -11.354,-8.279C-12.833,-9.29 -11.242,-9.27 -11.242,-9.27C-9.607,-9.154 -8.747,-7.591 -8.747,-7.591C-7.294,-5.102 -4.934,-5.821 -4.006,-6.237C-3.858,-7.29 -3.438,-8.008 -2.972,-8.415C-6.589,-8.826 -10.392,-10.224 -10.392,-16.466C-10.392,-18.244 -9.757,-19.698 -8.715,-20.837C-8.883,-21.249 -9.442,-22.905 -8.556,-25.148C-8.556,-25.148 -7.188,-25.586 -4.076,-23.478C-2.777,-23.839 -1.383,-24.02 0.002,-24.026C1.385,-24.02 2.779,-23.839 4.08,-23.478C7.19,-25.586 8.555,-25.148 8.555,-25.148C9.444,-22.905 8.885,-21.249 8.717,-20.837C9.761,-19.698 10.392,-18.244 10.392,-16.466C10.392,-10.208 6.583,-8.831 2.954,-8.428C3.539,-7.925 4.06,-6.931 4.06,-5.411C4.06,-3.234 4.04,-1.477 4.04,-0.943C4.04,-0.507 4.333,0 5.16,-0.159C11.628,-2.318 16.291,-8.419 16.291,-15.614C16.291,-24.611 8.997,-31.904 0,-31.904"/>
      </g>
    </g>
  </g>
</svg>
    </a>
  </nav>
</header>
<nav class="pagenav pagenav--top">
  <div class="pagenav__item pagenav__item--prev">
    <a class="pagenav__link link" href="5b.html">
      <svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="5" y1="12" x2="19" y2="12"/>
  <line x1="5" y1="12" x2="11" y2="18"/>
  <line x1="5" y1="12" x2="11" y2="6"/>
</svg> Prev
    </a>
  </div>
  <div class="pagenav__item pagenav__item--up">
    <a class="pagenav__link link" href="index.html"><svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.75" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="12" y1="5" x2="12" y2="19"/>
  <line x1="18" y1="11" x2="12" y2="5"/>
  <line x1="6" y1="11" x2="12" y2="5"/>
</svg> Up</a>
  </div>
  <div class="pagenav__item pagenav__item--next">
    <a class="pagenav__link link" href="6b.html">
      Next <svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="5" y1="12" x2="19" y2="12"/>
  <line x1="13" y1="18" x2="19" y2="12"/>
  <line x1="13" y1="6" x2="19" y2="12"/>
</svg>
    </a>
  </div>
</nav>
<h1>
<small class="number">6A</small>Streams, Part 1
</h1>
<h2 id="1" class="anchor">
<a class="anchor__link link" href="#1">#</a>Part 1
</h2>
<h3 id="1.1" class="anchor">
<a class="anchor__link link" href="#1.1">#</a>Recap
</h3>
<ul>
<li>We’ve learned about assignment and its frightening implications.</li>
<li>The substitution model of evaluation breaks down; we have to use the much more complicated environment model.</li>
<li>Worry about: assignment, state, change, time, identity, objects, sharing.</li>
<li>Suddenly a variable doesn’t just stand for a value; it specifies a place that holds a value.</li>
<li>Our goal was <em>modularity</em>, writing programs that mirror reality.</li>
<li>Maybe we have the wrong view of reality; maybe time is an illusion and nothing changes.</li>
</ul>
<h3 id="1.2" class="anchor">
<a class="anchor__link link" href="#1.2">#</a>Motivation
</h3>
<ul>
<li>We’re going to look at another way to decompose systems: <em>stream processing</em>.</li>
<li>Consider summing the odd squares in a binary tree of integers:</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(sum-odd-squares tree)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  (<span class="ex">if</span><span class="fu"> </span>(leaf-node? tree)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      (<span class="ex">if</span><span class="fu"> </span>(<span class="kw">odd?</span> tree)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>          (square tree)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>          <span class="dv">0</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      (<span class="op">+</span> (sum-odd-squares (left-branch tree))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>         (sum-odd-squares (right-branch tree)))))</span></code></pre></div>
<ul>
<li>And contrast with collecting the odd Fibonacci numbers:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(odd-fibs n)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  (<span class="ex">define</span><span class="fu"> </span>(next k)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    (<span class="ex">if</span><span class="fu"> </span>(<span class="op">&gt;</span> k n)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>        &#39;()</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        (<span class="ex">let</span><span class="fu"> </span>((f (fib k)))</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>          (<span class="ex">if</span><span class="fu"> </span>(<span class="kw">odd?</span> f)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>              (<span class="kw">cons</span> f (next (<span class="kw">1+</span> k)))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>              (next (<span class="kw">1+</span> k))))))</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  (next <span class="dv">1</span>))</span></code></pre></div>
<ul>
<li>1st procedure: enumerate leaves → filter <code>odd?</code> → map <code>square</code> → accumulate <code>+</code>, 0.</li>
<li>2nd procedure: enumerate interval → map <code>fib</code> → filter <code>odd?</code> → accumulate <code>cons</code>, <code>'()</code>.</li>
<li>These are similar, but the commonality is obscured by how we wrote the procedures.</li>
</ul>
<blockquote>
<p>Going back to this fundamental principle of computer science that in order to control something you need the name of it.</p>
</blockquote>
<h3 id="1.3" class="anchor">
<a class="anchor__link link" href="#1.3">#</a>Defining streams
</h3>
<ul>
<li>The arrows between the boxes represent data structures called <em>streams</em>.</li>
<li><code class="sourceCode scheme">(<span class="ex">cons-stream</span><span class="fu"> x </span>y)</code> and <code>the-empty-stream</code> construct streams.</li>
<li>For any <code>x</code> and <code>y</code>, <code class="sourceCode scheme">(head (<span class="ex">cons-stream</span><span class="fu"> x </span>y))</code> is <code>x</code>.</li>
<li>For any <code>x</code> and <code>y</code>, <code class="sourceCode scheme">(tail (<span class="ex">cons-stream</span><span class="fu"> x </span>y))</code> is <code>y</code>.</li>
<li>We can define higher-order procedures like we did for lists:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(map-stream proc s)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  (<span class="ex">if</span><span class="fu"> </span>(empty-stream? s)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      the-empty-stream</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>      (<span class="ex">cons-stream</span><span class="fu"> </span>(proc (head s))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                   (map-stream proc (tail se)))))</span></code></pre></div>
<h3 id="1.4" class="anchor">
<a class="anchor__link link" href="#1.4">#</a>Using the language
</h3>
<ul>
<li>Now we can reimplement those problems with explicit stream processing:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(sum-odd-squares tree)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  (accumulate <span class="op">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>              <span class="dv">0</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>              (<span class="kw">map</span> square</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                   (<span class="kw">filter</span> odd</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                           (enumerate-tree tree)))))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(odd-fibs n)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  (accumulate <span class="kw">cons</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>              &#39;()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>              (<span class="kw">filter</span> odd</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>                      (<span class="kw">map</span> fib</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                           (enumerate-interval <span class="dv">1</span> n)))))</span></code></pre></div>
<ul>
<li>This reveals their commonality, and makes it easy to mix and match boxes.</li>
<li>The advantage of stream processing is that it establishes <em>conventional interfaces</em>.</li>
<li>Conventional interfaces are powerful because we can easily glue things together.</li>
</ul>
<h2 id="2" class="anchor">
<a class="anchor__link link" href="#2">#</a>Part 2
</h2>
<h3 id="2.1" class="anchor">
<a class="anchor__link link" href="#2.1">#</a>More complicated stream processing
</h3>
<ul>
<li>Suppose we have a stream of streams <span class="math inline">\{\{1,2,3,\dots\},\{10,20,30,\dots\},\dots\}</span>.</li>
<li>We can define a procedure <code>flatten</code> to accumulate them into a single flat stream.</li>
<li>Problem: Given <span class="math inline">N</span>, find all pairs <span class="math inline">0&lt;j&lt;i≤N</span> such that <span class="math inline">i+j</span> is prime.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(prime-sum-pairs n)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">map</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   (<span class="ex">lambda</span><span class="fu"> </span>(p)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>     (<span class="kw">list</span> (<span class="kw">car</span> p) (<span class="kw">cadr</span> p) (<span class="op">+</span> (<span class="kw">car</span> p) (<span class="kw">cadr</span> p))))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>   (<span class="kw">filter</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    (<span class="ex">lambda</span><span class="fu"> </span>(p)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>      (prime (<span class="op">+</span> (<span class="kw">car</span> p) (<span class="kw">cadr</span> p))))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    (flatmap</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>     (<span class="ex">lambda</span><span class="fu"> </span>(i)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">map</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        (<span class="ex">lambda</span><span class="fu"> </span>(j) (<span class="kw">list</span> i j))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        (enumerate-interval <span class="dv">1</span> (<span class="kw">-1+</span> i))))</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>     (enumerate-interval <span class="dv">1</span> n)))))</span></code></pre></div>
<ul>
<li><code>flatmap</code> takes the place of nested loops in most other languages.</li>
<li>We can simplify it with syntactic sugar <code>collect</code>:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(prime-sum-pairs n)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  (collect</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>   (<span class="kw">list</span> i j (<span class="op">+</span> i j))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>   ((i (enumerate-interval <span class="dv">1</span> n))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    (j (enumerate-interval <span class="dv">1</span> (<span class="kw">-1+</span> i))))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>   (prime? (<span class="op">+</span> i j))))</span></code></pre></div>
<h3 id="2.2" class="anchor">
<a class="anchor__link link" href="#2.2">#</a>Eight queens puzzle
</h3>
<ul>
<li>Solving this typically uses a <em>backtracking search</em>, navigating up and down the tree of possibilities until we get to the bottom (all queens placed).</li>
<li>This is unnecessary—it’s inordinately concerned with <em>time</em>.</li>
<li>A simpler way is to employ <em>wishful thinking</em> and go from <span class="math inline">k</span> columns to <span class="math inline">k+1</span> columns.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(queens size)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  (<span class="ex">define</span><span class="fu"> </span>(fill-cols k)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    (<span class="ex">if</span><span class="fu"> </span>(<span class="op">=</span> k <span class="dv">0</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>        (singleton empty-board)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        (collect (adjoin-position try-row k rest-queens)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                 ((rest-queens (fill-cols (<span class="kw">-1+</span> k)))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                  (try-row (enumerate-interval <span class="dv">1</span> size)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                 (safe? try-row k rest-queens))))</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  (fill-cols size))</span></code></pre></div>
<ul>
<li>This gives us <em>all solutions</em> to the <span class="math inline">k</span>-queens puzzle.</li>
<li>We changed our view from things that evolve in time and have state to a global view where we’re not concerned with time.</li>
</ul>
<h2 id="3" class="anchor">
<a class="anchor__link link" href="#3">#</a>Part 3
</h2>
<h3 id="3.1" class="anchor">
<a class="anchor__link link" href="#3.1">#</a>Streams are not lists
</h3>
<ul>
<li>By now you should be suspicious—what’s the catch?</li>
<li>Problem: Find the second prime between 10,000 and 1,000,000.</li>
<li>Stream solution: enumerate 10,000 to 1,000,000 → filter <code>prime?</code> → take 2nd.</li>
<li>This is ridiculously inefficient. Our earlier programs (before streams) were ugly because they mixed all the operations up, but because of this they were efficient.</li>
<li>But we can have our cake and eat it to! We can make it just as efficient.</li>
<li>The key to this is that streams are <em>not</em> lists.</li>
</ul>
<h3 id="3.2" class="anchor">
<a class="anchor__link link" href="#3.2">#</a>Implementing streams
</h3>
<ul>
<li>We want the stream to compute itself incrementally, to be an “on demand” data structure.
<ul>
<li><code class="sourceCode scheme">(<span class="ex">cons-stream</span><span class="fu"> x </span>y)</code> is an abbreviation for <code class="sourceCode scheme">(<span class="kw">cons</span> x (<span class="ex">delay</span><span class="fu"> y</span>))</code></li>
<li><code class="sourceCode scheme">(head s)</code> is <code class="sourceCode scheme">(<span class="kw">car</span> s)</code></li>
<li><code class="sourceCode scheme">(tail s)</code> is <code class="sourceCode scheme">(<span class="kw">force</span> (<span class="kw">cdr</span> s))</code></li>
</ul></li>
<li><code>delay</code> creates a promise to compute something when <code>force</code> d.
<ul>
<li><code class="sourceCode scheme">(<span class="ex">delay</span><span class="fu"> &lt;expr&gt;</span>)</code> is an abbreviation for <code class="sourceCode scheme">(<span class="ex">lambda</span><span class="fu"> </span>() &lt;expr&gt;)</code></li>
<li><code class="sourceCode scheme">(<span class="kw">force</span> p)</code> is <code>(p)</code></li>
</ul></li>
<li><code>delay</code> decouples the apparent order of events from the actual order of events that happen in the machine. We give up the idea that our procedures mirror some clear notion of time.</li>
<li>One little hack: to be efficient, <code class="sourceCode scheme">(<span class="ex">delay</span><span class="fu"> &lt;expr&gt;</span>)</code> is <code class="sourceCode scheme">(memo-proc (<span class="ex">lambda</span><span class="fu"> </span>() &lt;expr&gt;))</code>.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode scheme"><code class="sourceCode scheme"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(<span class="ex">define</span><span class="fu"> </span>(memo-proc proc)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  (<span class="ex">let</span><span class="fu"> </span>((already-run? nil) (result nil))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    (<span class="ex">lambda</span><span class="fu"> </span>()</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      (<span class="ex">if</span><span class="fu"> </span>(<span class="kw">not</span> already-run?)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>          (sequence (<span class="ex">set!</span><span class="fu"> result </span>(proc))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                    (<span class="ex">set!</span><span class="fu"> already-run? </span>(<span class="kw">not</span> nil))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                    result)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>          result))))</span></code></pre></div>
<ul>
<li>Streams blur the line between data structures and procedures.</li>
</ul>
<nav class="pagenav pagenav--bottom">
  <div class="pagenav__item pagenav__item--prev">
    <a class="pagenav__link link" href="5b.html">
      <svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="5" y1="12" x2="19" y2="12"/>
  <line x1="5" y1="12" x2="11" y2="18"/>
  <line x1="5" y1="12" x2="11" y2="6"/>
</svg> Prev
    </a>
  </div>
  <div class="pagenav__item pagenav__item--up">
    <a class="pagenav__link link" href="index.html"><svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="1.75" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="12" y1="5" x2="12" y2="19"/>
  <line x1="18" y1="11" x2="12" y2="5"/>
  <line x1="6" y1="11" x2="12" y2="5"/>
</svg> Up</a>
  </div>
  <div class="pagenav__item pagenav__item--next">
    <a class="pagenav__link link" href="6b.html">
      Next <svg class="arrow" width="18" height="18" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <line x1="5" y1="12" x2="19" y2="12"/>
  <line x1="13" y1="18" x2="19" y2="12"/>
  <line x1="13" y1="6" x2="19" y2="12"/>
</svg>
    </a>
  </div>
</nav>
<footer class="footer">
  © 2020 Mitchell Kember
</footer>
</body>
</html>
