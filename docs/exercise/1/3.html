<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SICP Section 1.3 Exercises</title>
  <link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css">
  <link rel="stylesheet" href="../../style.css">
</head>
<body>
<div hidden>
  <svg>
    <symbol id="up" viewBox="0 0 11 12">
      <path fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" d="M5.5.8v10.4m4.457-5.943L5.5.8 1.043 5.257"/>
    </symbol>
    <symbol id="left" viewBox="0 0 12 11">
      <path fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" d="M.8 5.5h10.4M5.257 9.957L.8 5.5l4.457-4.457"/>
    </symbol>
    <symbol id="right" viewBox="0 0 12 11">
      <use xlink:href="#left" transform="matrix(-1 0 0 1 12 0)"/>
    </symbol>
    <symbol id="external" viewBox="0 0 24 24">
      <path fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" d="M10.688 5.438H4.125A2.65 2.65 0 001.5 8.063v11.812A2.65 2.65 0 004.125 22.5h11.813a2.65 2.65 0 002.624-2.625v-6.563m-9.187 1.313L22.5 1.5m-6.563 0H22.5v6.563"/>
    </symbol>
  </svg>
</div>
<a class="skip-link" href="#main">Skip to main content</a>
<header class="header">
  <a class="title link" href="../../index.html">SICP Study</a>
  <nav class="sitenav" aria-label="site">
    <a class="sitenav__item link"
        href="../../text/index.html" aria-label="textbook notes">Text</a>
    <a class="sitenav__item link"
        href="../../lecture/index.html" aria-label="lecture notes">Lecture</a>
    <a class="sitenav__item sitenav__item--active link"
        href="../../exercise/index.html" aria-label="exercises">Exercise</a>
    <a class="sitenav__item sitenav__item--last link"
        href="https://github.com/mk12/sicp" aria-label="GitHub repository">
      Source
      <svg class="github-mark" width="25" height="25" viewBox="0 0 136 133" aria-hidden="true">
        <path fill="currentColor" d="M67.866.002C30.387.002 0 30.39 0 67.877c0 29.988 19.446 55.425 46.417 64.404 3.396.621 4.633-1.475 4.633-3.275 0-1.608-.058-5.879-.091-11.541-18.88 4.1-22.863-9.1-22.863-9.1-3.087-7.838-7.537-9.925-7.537-9.925-6.163-4.213.466-4.13.466-4.13 6.813.484 10.396 6.996 10.396 6.996 6.054 10.371 15.888 7.375 19.754 5.642.617-4.387 2.367-7.38 4.309-9.075-15.071-1.712-30.917-7.537-30.917-33.546 0-7.408 2.646-13.466 6.988-18.212-.7-1.717-3.03-8.617.662-17.963 0 0 5.7-1.825 18.667 6.959 5.412-1.505 11.22-2.259 16.992-2.284 5.762.025 11.57.78 16.991 2.284 12.959-8.784 18.646-6.959 18.646-6.959 3.704 9.346 1.375 16.246.675 17.963 4.35 4.746 6.98 10.804 6.98 18.212 0 26.075-15.872 31.813-30.992 33.492 2.437 2.096 4.608 6.237 4.608 12.57 0 9.072-.083 16.392-.083 18.617 0 1.817 1.22 3.93 4.666 3.267 26.95-8.996 46.38-34.417 46.38-64.396 0-37.487-30.392-67.875-67.88-67.875"/>
      </svg>      
    </a>
  </nav>
</header>
<nav class="pagenav pagenav--top" aria-label="page">
  <div class="pagenav__item pagenav__item--left">
    <a class="pagenav__link link" href="2.html" aria-label="previous page">
      <svg width="12" height="11" aria-hidden="true"><use xlink:href="#left"/>
      </svg><span class="pagenav__prev">Prev</span>
    </a>
  </div>
  <div class="pagenav__item pagenav__item--center">
    <a class="pagenav__link link" href="index.html" aria-label="parent page">
      <svg width="11" height="12" aria-hidden="true"><use xlink:href="#up"/>
      </svg><span class="pagenav__up">Up</span>
    </a>
  </div>
  <div class="pagenav__item pagenav__item--right">
    <a class="pagenav__link link" href="../2/index.html" aria-label="next page">
      <span class="pagenav__next">Next</span
        ><svg width="12" height="11" aria-hidden="true"
        ><use xlink:href="#right"/></svg>
    </a>
  </div>
</nav>
<main id="main">
<h1>
<span class="number">1.3</span> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html">Formulating Abstractions with Higher-Order Procedures<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h1>
<pre><code class="blockcode">(<span class="kw">define</span> (cube x) (<span class="fu">*</span> x x x))</code></pre>
<h2 id="1.3.1" class="anchor">
<a class="anchor__link link" href="#1.3.1" aria-hidden="true">#</a> <span class="number">1.3.1</span> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_sec_1.3.1">Procedures as Arguments<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h2>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#">1.3</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>cube</code>
</li>
</ul>
</li>
</ul>
</aside>
<p>Mathematicians long ago created an abstraction for summations:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>n</mi><mo>=</mo><mi>a</mi></mrow><mi>b</mi></munderover><mi>f</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo><mo>+</mo><mo>⋯</mo><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>b</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">\sum_{n=a}^b f(n) = f(a) + \dots + f(b).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.086118em;vertical-align:-1.250005em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.836113em;"><span style="top:-1.8999949999999999em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mrel mtight">=</span><span class="mord mathnormal mtight">a</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.250005em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span></p>
<p>We can do the same in Lisp using a higher-order procedure:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (sum term a next b)
  (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
      <span class="cn">0</span>
      (<span class="fu">+</span> (term a)
         (sum term (next a) next b))))

(<span class="kw">define</span> (inc n) (<span class="fu">+</span> n <span class="cn">1</span>))
(<span class="kw">define</span> (sum-cubes a b) (sum cube a inc b))
(sum-cubes <span class="cn">1</span> <span class="cn">10</span>) <span class="op">=&gt;</span> <span class="cn">3025</span>

(<span class="kw">define</span> (identity x) x)
(<span class="kw">define</span> (sum-integers a b) (sum identity a inc b))
(sum-integers <span class="cn">1</span> <span class="cn">10</span>) <span class="op">=&gt;</span> <span class="cn">55</span>

(<span class="kw">define</span> (pi-sum a b)
  (<span class="kw">define</span> (pi-term x) (<span class="fu">/</span> <span class="cn">1.0</span> (<span class="fu">*</span> x (<span class="fu">+</span> x <span class="cn">2</span>))))
  (<span class="kw">define</span> (pi-next x) (<span class="fu">+</span> x <span class="cn">4</span>))
  (sum pi-term a pi-next b))
(<span class="fu">*</span> <span class="cn">8</span> (pi-sum <span class="cn">1</span> <span class="cn">1000</span>)) <span class="op">~&gt;</span> <span class="cn">3.139592655589783</span></code></pre>
<p>The definite integral of a function <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> between limits <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">a</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">b</span></span></span></span> can be approximated numerically using the formula</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>f</mi><mo>≈</mo><mrow><mo fence="true">[</mo><mi>f</mi><mrow><mo fence="true">(</mo><mi>a</mi><mo>+</mo><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mi>f</mi><mrow><mo fence="true">(</mo><mi>a</mi><mo>+</mo><mi>d</mi><mi>x</mi><mo>+</mo><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mi>f</mi><mrow><mo fence="true">(</mo><mi>a</mi><mo>+</mo><mn>2</mn><mi>d</mi><mi>x</mi><mo>+</mo><mfrac><mrow><mi>d</mi><mi>x</mi></mrow><mn>2</mn></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mo>⋯</mo><mtext> </mtext><mo fence="true">]</mo></mrow><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">
\int_a^bf\approx\left[
f\left(a+\frac{dx}{2}\right)
+ f\left(a+dx+\frac{dx}{2}\right)
+ f\left(a+2dx+\frac{dx}{2}\right)
+ \cdots
\right]dx
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.5109580000000005em;vertical-align:-0.9119499999999999em;"></span><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000004em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span></span></p>
<p>for small values of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>d</mi><mi>x</mi><mtext>.</mtext></mrow><annotation encoding="application/x-tex">dx\htmlClass{math-punctuation}{\text{.}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">.</span></span></span></span></span></span> We can express this directly as a procedure:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (integral f a b dx)
  (<span class="kw">define</span> (add-dx x)
    (<span class="fu">+</span> x dx))
  (<span class="fu">*</span> (sum f (<span class="fu">+</span> a (<span class="fu">/</span> dx <span class="cn">2.0</span>)) add-dx b)
     dx))

(integral cube <span class="cn">0</span> <span class="cn">1</span> <span class="cn">0.01</span>) <span class="op">~&gt;</span> <span class="cn">.24998750000000042</span>
(integral cube <span class="cn">0</span> <span class="cn">1</span> <span class="cn">0.001</span>) <span class="op">~&gt;</span> <span class="cn">.249999875000001</span></code></pre>
<h3 id="ex1.29" class="anchor">
<a class="anchor__link link" href="#ex1.29" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.29">Exercise 1.29<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#">1.3</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>cube</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>inc</code>
</li>
<li class="flat__item nowrap">
<code>sum</code>
</li>
</ul>
</li>
</ul>
</aside>
<p><em>Simpson’s rule</em> provides a more accurate method of numerical integration:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mo>∫</mo><mi>a</mi><mi>b</mi></msubsup><mi>f</mi><mo>≈</mo><mfrac><mi>h</mi><mn>3</mn></mfrac><mrow><mo fence="true">[</mo><msub><mi>y</mi><mn>0</mn></msub><mo>+</mo><mn>4</mn><msub><mi>y</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><msub><mi>y</mi><mn>3</mn></msub><mo>+</mo><mn>2</mn><msub><mi>y</mi><mn>4</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><mn>2</mn><msub><mi>y</mi><mrow><mi>n</mi><mo>−</mo><mn>2</mn></mrow></msub><mo>+</mo><mn>4</mn><msub><mi>y</mi><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>y</mi><mi>n</mi></msub><mo fence="true">]</mo></mrow><mi>d</mi><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>where</mtext><mspace width="1em"/><mi>h</mi><mo>=</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mi>n</mi></mfrac><mspace width="1em"/><mtext>and</mtext><mspace width="1em"/><msub><mi>y</mi><mi>k</mi></msub><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>a</mi><mo>+</mo><mi>k</mi><mi>h</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{gathered}
\int_a^bf\approx\frac{h}{3}\left[
y_0 + 4y_1 + 2y_2 + 4y_3 + 2y_4 + \cdots + 2y_{n-2} + 4y_{n-1} + y_n
\right]dx \\
\text{where}\quad h = \frac{b-a}{n} \quad\text{and}\quad y_k = f(a+kh).
\end{gathered}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:5.168398em;vertical-align:-2.334199em;"></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.834199em;"><span style="top:-4.834199em;"><span class="pstrut" style="height:3.5990080000000004em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol large-op" style="margin-right:0.44445em;position:relative;top:-0.0011249999999999316em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5990080000000004em;"><span style="top:-1.7880500000000001em;margin-left:-0.44445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span><span style="top:-3.812900000000001em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9119499999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">h</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.301108em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span><span style="top:-2.2508090000000007em;"><span class="pstrut" style="height:3.5990080000000004em;"></span><span class="mord"><span class="mord text"><span class="mord">where</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord mathnormal">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord text"><span class="mord">and</span></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mord mathnormal">h</span><span class="mclose">)</span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.334199em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>The even integer <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> controls the accuracy of the approximation.</p>
<pre><code class="blockcode">(<span class="kw">define</span> (simpson f a b n)
  (<span class="kw">let</span> ((h (<span class="fu">/</span> (<span class="fu">-</span> b a) n)))
    (<span class="kw">define</span> (term k)
      (<span class="fu">*</span> (f (<span class="fu">+</span> a (<span class="fu">*</span> k h)))
         (<span class="kw">if</span> (<span class="kw">or</span> (<span class="fu">=</span> k <span class="cn">0</span>) (<span class="fu">=</span> k n))
             <span class="cn">1</span>
             (<span class="fu">+</span> <span class="cn">2</span> (<span class="fu">*</span> <span class="cn">2</span> (<span class="fu">remainder</span> k <span class="cn">2</span>))))))
    (<span class="fu">*</span> h <span class="cn">1/3</span> (sum term <span class="cn">0.0</span> inc n))))</code></pre>
<p>Simpson’s rule gives an exact answer for <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>x</mi><mn>3</mn></msup><mi>d</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">\int_0^1x^3dx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3648280000000002em;vertical-align:-0.35582em;"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:0.19445em;position:relative;top:-0.0005599999999999772em;">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0090080000000001em;"><span style="top:-2.34418em;margin-left:-0.19445em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span><span style="top:-3.2579000000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35582em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mord mathnormal">d</span><span class="mord mathnormal">x</span></span></span></span> when <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>=</mo><mn>2</mn><mtext>:</mtext></mrow><annotation encoding="application/x-tex">n=2\htmlClass{math-punctuation}{\text{:}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">:</span></span></span></span></span></span></p>
<pre><code class="blockcode">(simpson cube <span class="cn">0</span> <span class="cn">1</span> <span class="cn">2</span>) <span class="op">=&gt;</span> <span class="cn">0.25</span></code></pre>
<h3 id="ex1.30" class="anchor">
<a class="anchor__link link" href="#ex1.30" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.30">Exercise 1.30<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<pre><code class="blockcode">(<span class="kw">define</span> (sum term a next b)
  (<span class="kw">define</span> (iter a acc)
    (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
        acc
        (iter (next a) (<span class="fu">+</span> acc (term a)))))
  (iter a <span class="cn">0</span>))</code></pre>
<h3 id="ex1.31" class="anchor">
<a class="anchor__link link" href="#ex1.31" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.31">Exercise 1.31<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>identity</code>
</li>
<li class="flat__item nowrap">
<code>inc</code>
</li>
</ul>
</li>
</ul>
</aside>
<ol type="a">
<li>Recursive:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (product term a next b)
  (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
      <span class="cn">1</span>
      (<span class="fu">*</span> (term a)
         (product term (next a) next b))))</code></pre>
<ol start="2" type="a">
<li>Iterative:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (product term a next b)
  (<span class="kw">define</span> (iter a acc)
    (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
        acc
        (iter (next a) (<span class="fu">*</span> acc (term a)))))
  (iter a <span class="cn">1</span>))</code></pre>
<p>Calculating factorials and approximating <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">\pi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> using <code>product</code>:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (factorial n)
  (product identity <span class="cn">1</span> inc n))

(factorial <span class="cn">5</span>) <span class="op">=&gt;</span> <span class="cn">120</span>
(factorial <span class="cn">7</span>) <span class="op">=&gt;</span> <span class="cn">5040</span>

(<span class="kw">define</span> (approx-pi n)
  (<span class="kw">define</span> (term k)
    (<span class="kw">let</span> ((r (<span class="fu">remainder</span> k <span class="cn">2</span>)))
      (<span class="fu">/</span> (<span class="fu">+</span> k <span class="cn">2</span> (<span class="fu">-</span> r))
         (<span class="fu">+</span> k <span class="cn">1</span> r))))
  (<span class="fu">*</span> <span class="cn">4</span> (product term <span class="cn">1.0</span> inc n)))

(approx-pi <span class="cn">00010</span>) <span class="op">~&gt;</span> <span class="cn">3.2751010413348065</span>
(approx-pi <span class="cn">00100</span>) <span class="op">~&gt;</span> <span class="cn">3.1570301764551654</span>
(approx-pi <span class="cn">01000</span>) <span class="op">~&gt;</span> <span class="cn">3.1431607055322552</span>
(approx-pi <span class="cn">10000</span>) <span class="op">~&gt;</span> <span class="cn">3.1417497057380084</span></code></pre>
<h3 id="ex1.32" class="anchor">
<a class="anchor__link link" href="#ex1.32" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.32">Exercise 1.32<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>identity</code>
</li>
<li class="flat__item nowrap">
<code>inc</code>
</li>
</ul>
</li>
</ul>
</aside>
<ol type="a">
<li>Recursive:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (accumulate combine id term a next b)
  (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
      id
      (combine (term a)
               (accumulate combine id term (next a) next b))))</code></pre>
<ol start="2" type="a">
<li>Iterative:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (accumulate combine id term a next b)
  (<span class="kw">define</span> (iter a acc)
    (<span class="kw">if</span> (<span class="fu">&gt;</span> a b)
        acc
        (iter (next a) (combine (term a) acc))))
  (iter a id))</code></pre>
<p>Implementing <code>sum</code> and <code>product</code> in terms of <code>accumulate</code>:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (sum term a next b)
  (accumulate <span class="fu">+</span> <span class="cn">0</span> term a next b))

(<span class="kw">define</span> (product term a next b)
  (accumulate <span class="fu">*</span> <span class="cn">1</span> term a next b))

(sum identity <span class="cn">1</span> inc <span class="cn">10</span>) <span class="op">=&gt;</span> <span class="cn">55</span>
(product identity <span class="cn">1</span> inc <span class="cn">10</span>) <span class="op">=&gt;</span> <span class="cn">3628800</span></code></pre>
<h3 id="ex1.33" class="anchor">
<a class="anchor__link link" href="#ex1.33" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.33">Exercise 1.33<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>identity</code>
</li>
<li class="flat__item nowrap">
<code>inc</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="2.html#ex1.23">Ex 1.23</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>prime?</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (filtered-accumulate combine pred? id term a next b)
  (<span class="kw">define</span> (iter a acc)
    (<span class="kw">cond</span> ((<span class="fu">&gt;</span> a b) acc)
          ((pred? a)
           (iter (next a) (combine (term a) acc)))
          (<span class="kw">else</span> (iter (next a) acc))))
  (iter a id))</code></pre>
<ol type="a">
<li>Sum of squares of primes in the interval from <code>a</code> to <code>b</code>:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (sum-squared-primes a b)
  (filtered-accumulate <span class="fu">+</span> prime? <span class="cn">0</span> square a inc b))

(sum-squared-primes <span class="cn">10</span> <span class="cn">15</span>) <span class="op">=&gt;</span> <span class="cn">290</span></code></pre>
<ol start="2" type="a">
<li>Product of positive integers below <code>n</code> relatively prime to <code>n</code>:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (product-rel-prime n)
  (<span class="kw">define</span> (rel-prime? i)
    (<span class="fu">=</span> (<span class="fu">gcd</span> i n) <span class="cn">1</span>))
  (filtered-accumulate <span class="fu">*</span> rel-prime? <span class="cn">1</span> identity <span class="cn">1</span> inc (<span class="fu">-</span> n <span class="cn">1</span>)))

(product-rel-prime <span class="cn">10</span>) <span class="op">=&gt;</span> (<span class="fu">*</span> <span class="cn">3</span> <span class="cn">7</span> <span class="cn">9</span>)</code></pre>
<h2 id="1.3.2" class="anchor">
<a class="anchor__link link" href="#1.3.2" aria-hidden="true">#</a> <span class="number">1.3.2</span> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_sec_1.3.2">Constructing Procedures Using <code>Lambda</code><span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h2>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">((<span class="kw">lambda</span> (x y z) (<span class="fu">+</span> x y (square z))) <span class="cn">1</span> <span class="cn">2</span> <span class="cn">3</span>) <span class="op">=&gt;</span> <span class="cn">12</span></code></pre>
<h3 id="ex1.34" class="anchor">
<a class="anchor__link link" href="#ex1.34" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.34">Exercise 1.34<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (f g) (g <span class="cn">2</span>))

(f square) <span class="op">=&gt;</span> <span class="cn">4</span>
(f (<span class="kw">lambda</span> (z) (<span class="fu">*</span> z (<span class="fu">+</span> z <span class="cn">1</span>)))) <span class="op">=&gt;</span> <span class="cn">6</span></code></pre>
<p>If we try evaluating the combination <code>(f f)</code>, we get the process <code>(f f) <span class="op">=&gt;</span> (f <span class="cn">2</span>) <span class="op">=&gt;</span> (<span class="cn">2</span> <span class="cn">2</span>)</code>. This fails because 2 is not a procedure:</p>
<pre><code class="blockcode">(f f) <span class="er">=!&gt;</span> <span class="cn">&quot;2&quot;</span></code></pre>
<h2 id="1.3.3" class="anchor">
<a class="anchor__link link" href="#1.3.3" aria-hidden="true">#</a> <span class="number">1.3.3</span> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_sec_1.3.3">Procedures as General Methods<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h2>
<h3 id="1.3.3.1" class="anchor">
<a class="anchor__link link" href="#1.3.3.1" aria-hidden="true">#</a> <span class="number">1.3.3.1</span> Finding roots of equations by the half-interval method
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (search f neg-point pos-point)
  (<span class="kw">let</span> ((midpoint (average neg-point pos-point)))
    (<span class="kw">if</span> (close-enough? neg-point pos-point)
        midpoint
        (<span class="kw">let</span> ((test-value (f midpoint)))
          (<span class="kw">cond</span> ((<span class="fu">positive?</span> test-value)
                 (search f neg-point midpoint))
                ((<span class="fu">negative?</span> test-value)
                 (search f midpoint pos-point))
                (<span class="kw">else</span> midpoint))))))

(<span class="kw">define</span> tolerance <span class="cn">0.001</span>)
(<span class="kw">define</span> (close-enough? x y) (<span class="fu">&lt;</span> (<span class="fu">abs</span> (<span class="fu">-</span> x y)) tolerance))</code></pre>
<p>Half interval method: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Θ</mi><mo stretchy="false">(</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mrow><mo fence="true">∣</mo><mi>a</mi><mo>−</mo><mi>b</mi><mo fence="true">∣</mo></mrow><mi mathvariant="normal">/</mi><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">Θ(\log(\abs{a-b}/t))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Θ</span><span class="mopen">(</span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">b</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">/</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> time where <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span> is <code>tolerance</code>.</p>
<pre><code class="blockcode">(<span class="kw">define</span> (half-interval-method f a b)
  (<span class="kw">let</span> ((a-value (f a))
        (b-value (f b)))
    (<span class="kw">cond</span> ((<span class="kw">and</span> (<span class="fu">negative?</span> a-value) (<span class="fu">positive?</span> b-value))
           (search f a b))
          ((<span class="kw">and</span> (<span class="fu">negative?</span> b-value) (<span class="fu">positive?</span> a-value))
           (search f b a))
          (<span class="kw">else</span>
           (<span class="fu">error</span> <span class="cn">&#39;half-interval-method</span>
                  <span class="cn">&quot;values are not of opposite sign&quot;</span>
                  a b)))))

(half-interval-method <span class="fu">sin</span> <span class="cn">2.0</span> <span class="cn">4.0</span>)
<span class="op">~&gt;</span> <span class="cn">3.14111328125</span>
(half-interval-method (<span class="kw">lambda</span> (x) (<span class="fu">-</span> (<span class="fu">*</span> x x x) (<span class="fu">*</span> <span class="cn">2</span> x) <span class="cn">3</span>)) <span class="cn">1.0</span> <span class="cn">2.0</span>)
<span class="op">~&gt;</span> <span class="cn">1.89306640625</span>
(half-interval-method <span class="fu">cos</span> <span class="cn">-1</span> <span class="cn">1</span>)
<span class="er">=!&gt;</span> <span class="cn">&quot;values are not of opposite sign: -1 1&quot;</span></code></pre>
<h3 id="1.3.3.2" class="anchor">
<a class="anchor__link link" href="#1.3.3.2" aria-hidden="true">#</a> <span class="number">1.3.3.2</span> Finding fixed points of functions
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> tolerance <span class="cn">0.00001</span>)
(<span class="kw">define</span> (close-enough? x y) (<span class="fu">&lt;</span> (<span class="fu">abs</span> (<span class="fu">-</span> x y)) tolerance))

(<span class="kw">define</span> (fixed-point f first-guess)
  (<span class="kw">define</span> (try guess)
    (<span class="kw">let</span> ((next (f guess)))
      (<span class="kw">if</span> (close-enough? guess next)
          next
          (try next))))
  (try first-guess))

(fixed-point <span class="fu">cos</span> <span class="cn">1.0</span>) <span class="op">~&gt;</span> <span class="cn">0.7390822985224023</span></code></pre>
<p>Without average damping, it does not converge:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (fixed-point (<span class="kw">lambda</span> (y) (<span class="fu">/</span> x y)) <span class="cn">1.0</span>))

<span class="co">; (sqrt 2) ; never terminates</span></code></pre>
<p>With average damping, it converges:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (fixed-point (<span class="kw">lambda</span> (y) (average y (<span class="fu">/</span> x y))) <span class="cn">1.0</span>))

(<span class="fu">sqrt</span> <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">1.4142135623746899</span></code></pre>
<h3 id="ex1.35" class="anchor">
<a class="anchor__link link" href="#ex1.35" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.35">Exercise 1.35<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>fixed-point</code>
</li>
</ul>
</li>
</ul>
</aside>
<p><strong>Theorem.</strong> The golden ratio <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi></mrow><annotation encoding="application/x-tex">\varphi</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span></span></span></span> is a fixed point of the transformation <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>↦</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>x</mi><mtext>.</mtext></mrow><annotation encoding="application/x-tex">x\mapsto 1+1/x\htmlClass{math-punctuation}{\text{.}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.522em;vertical-align:-0.011em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">↦</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">x</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">.</span></span></span></span></span></span></p>
<p><em>Proof.</em> We will show that for any <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>x</mi><mtext>,</mtext></mrow><annotation encoding="application/x-tex">y=1+1/x\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">x</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">∣</mo><mi>y</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow><mo>&lt;</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\abs{y-\varphi}&lt;\abs{x-\varphi}\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> meaning each iteration brings the value closer to <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mtext>.</mtext></mrow><annotation encoding="application/x-tex">\varphi\htmlClass{math-punctuation}{\text{.}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">.</span></span></span></span></span></span> Recall from <a href="2.html#ex1.13">Exercise&nbsp;1.13</a> the golden ratio equation <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mo>+</mo><mn>1</mn><mo>=</mo><msup><mi>φ</mi><mn>2</mn></msup><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\varphi+1=\varphi^2\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> or equivalently <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mo>=</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>φ</mi><mtext>:</mtext></mrow><annotation encoding="application/x-tex">\varphi=1+1/\varphi\htmlClass{math-punctuation}{\text{:}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">φ</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">:</span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left right" columnspacing="0em 1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">∣</mo><mi>y</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mn>1</mn><mo>+</mo><mfrac><mn>1</mn><mi>x</mi></mfrac><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>−</mo><mi>φ</mi><mi>x</mi></mrow><mi>x</mi></mfrac><mo fence="true">∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mfrac><mrow><mi>x</mi><mo>+</mo><mn>1</mn><mo>−</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>φ</mi><mo stretchy="false">)</mo><mi>x</mi></mrow><mi>x</mi></mfrac><mo fence="true">∣</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>since </mtext><mstyle scriptlevel="0" displaystyle="false"><mi>φ</mi><mo>=</mo><mn>1</mn><mo>+</mo><mn>1</mn><mi mathvariant="normal">/</mi><mi>φ</mi></mstyle></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence="true">∣</mo><mfrac><mrow><mi>φ</mi><mo>−</mo><mi>x</mi></mrow><mrow><mi>x</mi><mi>φ</mi></mrow></mfrac><mo fence="true">∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow><mrow><mo fence="true">∣</mo><mi>x</mi><mi>φ</mi><mo fence="true">∣</mo></mrow></mfrac><mi mathvariant="normal">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\abs{y-\varphi} &amp;= \abs{1+\frac{1}{x}-\varphi} \\
&amp;= \abs{\frac{x+1-\varphi x}{x}} \\
&amp;= \abs{\frac{x+1-(1+1/\varphi)x}{x}} &amp; \text{since $\varphi=1+1/\varphi$} \\
&amp;= \abs{\frac{\varphi-x}{x\varphi}} \\
&amp;= \frac{\abs{x-\varphi}}{\abs{x\varphi}}.
\end{aligned}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:13.58296em;vertical-align:-6.54148em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.04148em;"><span style="top:-9.04148em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span><span style="top:-6.31149em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"></span></span><span style="top:-3.5814999999999984em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"></span></span><span style="top:-0.8515099999999995em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"></span></span><span style="top:1.8255099999999995em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.54148em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:7.04148em;"><span style="top:-9.04148em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-6.31149em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.5814999999999984em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">/</span><span class="mord mathnormal">φ</span><span class="mclose">)</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-0.8515099999999995em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2603300000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mord mathnormal">φ</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8804400000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.4799700000000002em;"><span style="top:-1.65598em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.25698em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.85798em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-2.87897em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span><span style="top:-3.47997em;"><span class="pstrut" style="height:2.606em;"></span><span class="delimsizinginner delim-size1"><span>∣</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500199999999999em;"><span></span></span></span></span></span></span></span></span></span><span style="top:1.8255099999999995em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">x</span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord">.</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:6.54148em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5814999999999986em;"><span style="top:-3.5814999999999992em;"><span class="pstrut" style="height:3.4799700000000002em;"></span><span class="mord"><span class="mord text"><span class="mord">since </span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1/</span><span class="mord mathnormal">φ</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1484900000000013em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>Since <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>φ</mi><mo>&gt;</mo><mn>1</mn><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\varphi&gt;1\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">φ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> we have <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">∣</mo><mi>x</mi><mi>φ</mi><mo fence="true">∣</mo></mrow><mo>&gt;</mo><mn>1</mn><mtext>,</mtext></mrow><annotation encoding="application/x-tex">\abs{x\varphi}&gt;1\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">x</span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> hence <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mo fence="true">∣</mo><mi>y</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow><mo>&lt;</mo><mrow><mo fence="true">∣</mo><mi>x</mi><mo>−</mo><mi>φ</mi><mo fence="true">∣</mo></mrow></mrow><annotation encoding="application/x-tex">\abs{y-\varphi}&lt;\abs{x-\varphi}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal">φ</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> as required. <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">■</mi></mrow><annotation encoding="application/x-tex">\blacksquare</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.675em;vertical-align:0em;"></span><span class="mord amsrm">■</span></span></span></span></p>
<pre><code class="blockcode">(<span class="kw">define</span> golden-ratio (<span class="fu">/</span> (<span class="fu">+</span> <span class="cn">1</span> (<span class="fu">sqrt</span> <span class="cn">5</span>)) <span class="cn">2</span>))

golden-ratio
<span class="op">~&gt;</span> <span class="cn">1.6180339887498950</span>
(fixed-point (<span class="kw">lambda</span> (x) (<span class="fu">+</span> <span class="cn">1</span> (<span class="fu">/</span> x))) <span class="cn">1.0</span>)
<span class="op">~&gt;</span> <span class="cn">1.6180327868852458</span></code></pre>
<h3 id="ex1.36" class="anchor">
<a class="anchor__link link" href="#ex1.36" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.36">Exercise 1.36<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>close-enough?</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (fixed-point-verbose f first-guess)
  (<span class="kw">define</span> (try guess)
    (<span class="kw">let</span> ((next (f guess)))
      (<span class="fu">display</span> next)
      (<span class="fu">newline</span>)
      (<span class="kw">if</span> (close-enough? guess next)
          next
          (try next))))
  (try first-guess))

(<span class="kw">define</span> (f x) (<span class="fu">/</span> (<span class="fu">log</span> <span class="cn">1000</span>) (<span class="fu">log</span> x)))</code></pre>
<p>Without average damping, it takes 28 approximations.</p>
<pre><code class="blockcode">(<span class="kw">hide-output</span> (fixed-point-verbose f <span class="cn">5</span>)) <span class="op">~&gt;</span> <span class="cn">4.555539314360711</span>
(<span class="fu">string-count</span> <span class="cn">#\newline</span> (<span class="kw">capture-output</span> (fixed-point-verbose f <span class="cn">5</span>))) <span class="op">=&gt;</span> <span class="cn">28</span></code></pre>
<p>With average damping, it takes only 8 approximations.</p>
<pre><code class="blockcode">(<span class="kw">define</span> (f-damped x) (average x (f x)))
(<span class="kw">hide-output</span> (fixed-point-verbose f-damped <span class="cn">5</span>)) <span class="op">~&gt;</span> <span class="cn">4.5555361005218895</span>
(<span class="fu">string-count</span> <span class="cn">#\newline</span> (<span class="kw">capture-output</span> (fixed-point-verbose f-damped <span class="cn">5</span>))) <span class="op">=&gt;</span> <span class="cn">8</span></code></pre>
<h3 id="ex1.37" class="anchor">
<a class="anchor__link link" href="#ex1.37" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.37">Exercise 1.37<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#ex1.35">Ex 1.35</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>golden-ratio</code>
</li>
</ul>
</li>
</ul>
</aside>
<ol type="a">
<li>Recursive process:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (cont-frac n d k)
  (<span class="kw">define</span> (helper i)
    (<span class="kw">if</span> (<span class="fu">=</span> i k)
        <span class="cn">0</span>
        (<span class="fu">/</span> (n i)
           (<span class="fu">+</span> (d i) (helper (<span class="fu">+</span> i <span class="cn">1</span>))))))
  (helper <span class="cn">1</span>))</code></pre>
<ol start="2" type="a">
<li>Iterative process:</li>
</ol>
<pre><code class="blockcode">(<span class="kw">define</span> (cont-frac n d k)
  (<span class="kw">define</span> (iter i acc)
    (<span class="kw">if</span> (<span class="fu">zero?</span> i)
        acc
        (iter (<span class="fu">-</span> i <span class="cn">1</span>) (<span class="fu">/</span> (n i)
                         (<span class="fu">+</span> (d i) acc)))))
  (iter k <span class="cn">0</span>))</code></pre>
<p>Approximating the inverse golden ratio using <code>cont-frac</code>:</p>
<pre><code class="blockcode">(<span class="kw">define</span> (always-one i) <span class="cn">1.0</span>)
(<span class="kw">define</span> (approx-igr k) (cont-frac always-one always-one k))</code></pre>
<p>When <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>=</mo><mn>11</mn><mtext>,</mtext></mrow><annotation encoding="application/x-tex">k = 11\htmlClass{math-punctuation}{\text{,}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mord">1</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">,</span></span></span></span></span></span> the value is accurate to 4 decimal places:</p>
<pre><code class="blockcode">(approx-igr <span class="cn">01</span>) <span class="op">~&gt;</span> <span class="cn">1.0</span>
(approx-igr <span class="cn">02</span>) <span class="op">~&gt;</span> <span class="cn">0.5</span>
(approx-igr <span class="cn">03</span>) <span class="op">~&gt;</span> <span class="cn">0.6666666666666666</span>
(approx-igr <span class="cn">04</span>) <span class="op">~&gt;</span> <span class="cn">0.6000000000000001</span>
(approx-igr <span class="cn">05</span>) <span class="op">~&gt;</span> <span class="cn">0.625</span>
(approx-igr <span class="cn">06</span>) <span class="op">~&gt;</span> <span class="cn">0.6153846153846154</span>
(approx-igr <span class="cn">07</span>) <span class="op">~&gt;</span> <span class="cn">0.6190476190476191</span>
(approx-igr <span class="cn">08</span>) <span class="op">~&gt;</span> <span class="cn">0.6176470588235294</span>
(approx-igr <span class="cn">09</span>) <span class="op">~&gt;</span> <span class="cn">0.6181818181818182</span>
(approx-igr <span class="cn">10</span>) <span class="op">~&gt;</span> <span class="cn">0.6179775280898876</span>
(approx-igr <span class="cn">11</span>) <span class="op">~&gt;</span> <span class="cn">0.6180555555555556</span>

(<span class="kw">define</span> (round4 x) (<span class="fu">*</span> <span class="cn">1e-4</span> (<span class="fu">truncate</span> (<span class="fu">*</span> <span class="cn">1e4</span> x))))
(round4 (approx-igr <span class="cn">11</span>)) <span class="op">~&gt;</span> (round4 (<span class="fu">/</span> golden-ratio))</code></pre>
<h3 id="ex1.38" class="anchor">
<a class="anchor__link link" href="#ex1.38" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.38">Exercise 1.38<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#ex1.37">Ex 1.37</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>always-one</code>
</li>
<li class="flat__item nowrap">
<code>cont-frac</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (approx-e k)
  (<span class="kw">define</span> (d i)
    (<span class="kw">if</span> (<span class="fu">zero?</span> (<span class="fu">remainder</span> (<span class="fu">+</span> i <span class="cn">1</span>) <span class="cn">3</span>))
        (<span class="fu">*</span> <span class="cn">2/3</span> (<span class="fu">+</span> i <span class="cn">1</span>))
        <span class="cn">1</span>))
  (<span class="fu">+</span> <span class="cn">2</span> (cont-frac always-one d k)))

(approx-e <span class="cn">1</span>) <span class="op">~&gt;</span> <span class="cn">3.0</span>
(approx-e <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">2.6666666666666665</span>
(approx-e <span class="cn">3</span>) <span class="op">~&gt;</span> <span class="cn">2.75</span>
(approx-e <span class="cn">4</span>) <span class="op">~&gt;</span> <span class="cn">2.7142857142857144</span>
(approx-e <span class="cn">5</span>) <span class="op">~&gt;</span> <span class="cn">2.71875</span>
(approx-e <span class="cn">1000</span>) <span class="op">~&gt;</span> <span class="cn">2.7182818284590455</span></code></pre>
<h3 id="ex1.39" class="anchor">
<a class="anchor__link link" href="#ex1.39" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.39">Exercise 1.39<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#ex1.37">Ex 1.37</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>cont-frac</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (tan-cf x k)
  (cont-frac
   (<span class="kw">lambda</span> (i) (<span class="kw">if</span> (<span class="fu">=</span> i <span class="cn">1</span>) x (<span class="fu">-</span> (square x))))
   (<span class="kw">lambda</span> (i) (<span class="fu">-</span> (<span class="fu">*</span> i <span class="cn">2</span>) <span class="cn">1</span>))
   k))

(<span class="kw">define</span> quarter-pi (<span class="fu">atan</span> <span class="cn">1</span>))

(tan-cf quarter-pi <span class="cn">1</span>) <span class="op">~&gt;</span> <span class="cn">0.7853981633974483</span>
(tan-cf quarter-pi <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">0.9886892399342050</span>
(tan-cf quarter-pi <span class="cn">3</span>) <span class="op">~&gt;</span> <span class="cn">0.9997876809149684</span>
(tan-cf quarter-pi <span class="cn">4</span>) <span class="op">~&gt;</span> <span class="cn">0.9999978684156948</span>
(tan-cf quarter-pi <span class="cn">5</span>) <span class="op">~&gt;</span> <span class="cn">0.9999999865263550</span>
(<span class="fu">tan</span> quarter-pi) <span class="op">~&gt;</span> <span class="cn">1</span></code></pre>
<h2 id="1.3.4" class="anchor">
<a class="anchor__link link" href="#1.3.4" aria-hidden="true">#</a> <span class="number">1.3.4</span> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_sec_1.3.4">Procedures as Returned Values<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h2>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>fixed-point</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (average-damp f)
  (<span class="kw">lambda</span> (x) (average x (f x))))

((average-damp square) <span class="cn">10</span>) <span class="op">=&gt;</span> <span class="cn">55</span>

(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (fixed-point (average-damp (<span class="kw">lambda</span> (y) (<span class="fu">/</span> x y))) <span class="cn">1.0</span>))

(<span class="kw">define</span> (cbrt x)
  (fixed-point (average-damp (<span class="kw">lambda</span> (y) (<span class="fu">/</span> x (square y)))) <span class="cn">1.0</span>))</code></pre>
<h3 id="1.3.4.1" class="anchor">
<a class="anchor__link link" href="#1.3.4.1" aria-hidden="true">#</a> <span class="number">1.3.4.1</span> Newton’s method
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>fixed-point</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> dx <span class="cn">0.00001</span>)
(<span class="kw">define</span> (deriv g)
  (<span class="kw">lambda</span> (x) (<span class="fu">/</span> (<span class="fu">-</span> (g (<span class="fu">+</span> x dx)) (g x)) dx)))

(<span class="kw">define</span> (cube x) (<span class="fu">*</span> x x x))
((deriv cube) <span class="cn">5</span>) <span class="op">~&gt;</span> <span class="cn">75.00014999664018</span>

(<span class="kw">define</span> (newton-transform g)
  (<span class="kw">lambda</span> (x) (<span class="fu">-</span> x (<span class="fu">/</span> (g x) ((deriv g) x)))))
(<span class="kw">define</span> (newtons-method g guess)
  (fixed-point (newton-transform g) guess))

(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (newtons-method (<span class="kw">lambda</span> (y) (<span class="fu">-</span> (square y) x)) <span class="cn">1.0</span>))</code></pre>
<h3 id="1.3.4.2" class="anchor">
<a class="anchor__link link" href="#1.3.4.2" aria-hidden="true">#</a> <span class="number">1.3.4.2</span> Abstractions and first-class procedures
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>fixed-point</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.4">1.3.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average-damp</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.4.1">1.3.4.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>newton-transform</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (fixed-point-of-transform g transform guess)
  (fixed-point (transform g) guess))

(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (fixed-point-of-transform (<span class="kw">lambda</span> (y) (<span class="fu">/</span> x y)) average-damp <span class="cn">1.0</span>))

(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  (fixed-point-of-transform (<span class="kw">lambda</span> (y) (<span class="fu">-</span> (square y) x)) newton-transform <span class="cn">1.0</span>))</code></pre>
<h3 id="ex1.40" class="anchor">
<a class="anchor__link link" href="#ex1.40" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.40">Exercise 1.40<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.4.1">1.3.4.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>newtons-method</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (cubic a b c)
  (<span class="kw">lambda</span> (x)
    (<span class="kw">let</span> ((xx (square x)))
      (<span class="fu">+</span> (<span class="fu">*</span> x xx)
         (<span class="fu">*</span> a xx)
         (<span class="fu">*</span> b x)
         c))))</code></pre>
<p><code>(newtons-method (cubic <span class="ss">a</span> <span class="ss">b</span> <span class="ss">c</span>) <span class="cn">1.0</span>)</code> approximates a zero of <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>+</mo><mi>c</mi><mtext>:</mtext></mrow><annotation encoding="application/x-tex">x^3+ax^2+bx+c\htmlClass{math-punctuation}{\text{:}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="enclosing math-punctuation"><span class="mord text"><span class="mord">:</span></span></span></span></span></span></p>
<pre><code class="blockcode">(<span class="kw">define</span> f (cubic <span class="cn">-3</span> <span class="cn">1</span> <span class="cn">1</span>))
(f (newtons-method f <span class="cn">1.0</span>)) <span class="op">~&gt;</span> <span class="cn">0</span></code></pre>
<h3 id="ex1.41" class="anchor">
<a class="anchor__link link" href="#ex1.41" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.41">Exercise 1.41<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>inc</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (double f)
  (<span class="kw">lambda</span> (x)
    (f (f x))))

(((double (double double)) inc) <span class="cn">5</span>)
<span class="op">=&gt;</span> (((double (<span class="kw">lambda</span> (f) (double (double f)))) inc) <span class="cn">5</span>)
<span class="op">=&gt;</span> (((<span class="kw">lambda</span> (f) (double (double (double (double f))))) inc) <span class="cn">5</span>)
<span class="op">=&gt;</span> ((double (double (double (double inc)))) <span class="cn">5</span>)
<span class="op">=&gt;</span> ((double (double (double (<span class="kw">lambda</span> (x) (inc (inc x)))))) <span class="cn">5</span>)
<span class="op">=&gt;</span> ((double (double (<span class="kw">lambda</span> (x) (inc (inc (inc (inc x))))))) <span class="cn">5</span>)
<span class="op">=&gt;</span> ((double (<span class="kw">lambda</span> (x) (inc (inc (inc (inc (inc (inc (inc (inc x)))))))))) <span class="cn">5</span>)
<span class="op">=&gt;</span> ((<span class="kw">lambda</span> (x) (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc
      (inc (inc (inc (inc x))))))))))))))))) <span class="cn">5</span>)
<span class="op">=&gt;</span> (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc (inc
     (inc <span class="cn">5</span>))))))))))))))))
<span class="op">=&gt;</span> <span class="cn">21</span></code></pre>
<h3 id="ex1.42" class="anchor">
<a class="anchor__link link" href="#ex1.42" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.42">Exercise 1.42<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.1">1.3.1</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>inc</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (compose f g)
  (<span class="kw">lambda</span> (x)
    (f (g x))))

((compose square inc) <span class="cn">6</span>) <span class="op">=&gt;</span> <span class="cn">49</span></code></pre>
<h3 id="ex1.43" class="anchor">
<a class="anchor__link link" href="#ex1.43" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.43">Exercise 1.43<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#ex1.42">Ex 1.42</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>compose</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (repeated f n)
  (<span class="kw">if</span> (<span class="fu">=</span> n <span class="cn">1</span>)
      f
      (compose (repeated f (<span class="fu">-</span> n <span class="cn">1</span>)) f)))

((repeated square <span class="cn">2</span>) <span class="cn">5</span>) <span class="op">=&gt;</span> <span class="cn">625</span></code></pre>
<h3 id="ex1.44" class="anchor">
<a class="anchor__link link" href="#ex1.44" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.44">Exercise 1.44<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#ex1.43">Ex 1.43</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>repeated</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> dx <span class="cn">0.1</span>)
(<span class="kw">define</span> (smooth f)
  (<span class="kw">lambda</span> (x)
    (<span class="fu">/</span> (<span class="fu">+</span> (f (<span class="fu">-</span> x dx))
          (f x)
          (f (<span class="fu">+</span> x dx)))
       <span class="cn">3</span>)))

((smooth square) <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">4.006666666666667</span>
(((repeated smooth <span class="cn">5</span>) square) <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">4.033333333333333</span></code></pre>
<h3 id="ex1.45" class="anchor">
<a class="anchor__link link" href="#ex1.45" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.45">Exercise 1.45<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>fixed-point</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.4">1.3.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average-damp</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#ex1.43">Ex 1.43</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>repeated</code>
</li>
</ul>
</li>
</ul>
</aside>
<p>We need to average-damp <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">⌊</mo><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>n</mi><mo stretchy="false">⌋</mo></mrow><annotation encoding="application/x-tex">\lfloor\log_2n\rfloor</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">⌊</span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">n</span><span class="mclose">⌋</span></span></span></span> times.</p>
<pre><code class="blockcode">(<span class="kw">define</span> (nth-root x n)
  (fixed-point
   ((repeated average-damp
              (<span class="fu">floor</span> (<span class="fu">/</span> (<span class="fu">log</span> n) (<span class="fu">log</span> <span class="cn">2</span>))))
    (<span class="kw">lambda</span> (y) (<span class="fu">/</span> x (<span class="fu">expt</span> y (<span class="fu">-</span> n <span class="cn">1</span>)))))
   <span class="cn">1.0</span>))

(nth-root <span class="cn">4</span> <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">2.000000000000002</span>
(nth-root <span class="cn">256</span> <span class="cn">8</span>) <span class="op">~&gt;</span> <span class="cn">2.0000000000039666</span>
(nth-root <span class="cn">1048576</span> <span class="cn">20</span>) <span class="op">~&gt;</span> <span class="cn">1.999999063225966</span></code></pre>
<h3 id="ex1.46" class="anchor">
<a class="anchor__link link" href="#ex1.46" aria-hidden="true">#</a> <a class="link" href="https://mitpress.mit.edu/sites/default/files/sicp/full-text/book/book-Z-H-12.html#%25_thm_1.46">Exercise 1.46<span class="nowrap">⁠<svg class="external" width="24" height="24" aria-hidden="true"><use xlink:href="#external"/></svg></span></a>
</h3>
<aside class="imports">
<h4>
Imports:
</h4>
<ul class="flat">
<li class="flat__item">
<a href="1.html#1.1.4">1.1.4</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>square</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="1.html#1.1.7">1.1.7</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>average</code>,
</li>
</ul>
</li>
<li class="flat__item">
<a href="#1.3.3.2">1.3.3.2</a>
<ul class="flat">
<li class="flat__item nowrap">
<code>tolerance</code>
</li>
</ul>
</li>
</ul>
</aside>
<pre><code class="blockcode">(<span class="kw">define</span> (iterative-improve good-enough? improve)
  (<span class="kw">define</span> (iter guess)
    (<span class="kw">if</span> (good-enough? guess)
        guess
        (iter (improve guess))))
  iter)

(<span class="kw">define</span> (<span class="fu">sqrt</span> x)
  ((iterative-improve
    (<span class="kw">lambda</span> (guess)
      (<span class="fu">&lt;</span> (<span class="fu">abs</span> (<span class="fu">-</span> (square guess) x)) tolerance))
    (<span class="kw">lambda</span> (guess)
      (average guess (<span class="fu">/</span> x guess))))
   <span class="cn">1.0</span>))

(<span class="fu">sqrt</span> <span class="cn">2</span>) <span class="op">~&gt;</span> <span class="cn">1.4142156862745097</span>

(<span class="kw">define</span> (fixed-point f first-guess)
  ((iterative-improve
    (<span class="kw">lambda</span> (guess)
      (<span class="fu">&lt;</span> (<span class="fu">abs</span> (<span class="fu">-</span> guess (f guess))) tolerance))
    f)
   first-guess))</code></pre>
<p>This is slightly different from the original <code>fixed-point</code> because it returns <code>guess</code> when it’s good enough, not <code>next</code> (so the original always does one more improvement).</p>
<pre><code class="blockcode">(fixed-point <span class="fu">cos</span> <span class="cn">1.0</span>) <span class="op">~&gt;</span> <span class="cn">0.7390893414033928</span></code></pre>
</main>
<nav class="pagenav pagenav--bottom" aria-label="page">
  <div class="pagenav__item pagenav__item--left">
    <a class="pagenav__link link" href="2.html" aria-label="previous page">
      <svg width="12" height="11" aria-hidden="true"><use xlink:href="#left"/>
      </svg><span class="pagenav__prev">Prev</span>
    </a>
  </div>
  <div class="pagenav__item pagenav__item--center">
    <a class="pagenav__link link" href="index.html" aria-label="parent page">
      <svg width="11" height="12" aria-hidden="true"><use xlink:href="#up"/>
      </svg><span class="pagenav__up">Up</span>
    </a>
  </div>
  <div class="pagenav__item pagenav__item--right">
    <a class="pagenav__link link" href="../2/index.html" aria-label="next page">
      <span class="pagenav__next">Next</span
        ><svg width="12" height="11" aria-hidden="true"
        ><use xlink:href="#right"/></svg>
    </a>
  </div>
</nav>
<footer class="footer">
  <p>© 2021 Mitchell Kember</p>
</footer>
</body>
</html>
